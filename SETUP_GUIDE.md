# äº‘å¼€å‘é…ç½®åŠ è½½æŒ‡å—

## æ­¥éª¤ä¸€ï¼šå¼€é€šäº‘å¼€å‘æœåŠ¡

### 1. åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­æ“ä½œ

1. **æ‰“å¼€é¡¹ç›®**
   - åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­æ‰“å¼€ä½ çš„å°ç¨‹åºé¡¹ç›®
   - ç¡®ä¿é¡¹ç›®å·²æ­£ç¡®åŠ è½½

2. **å¼€é€šäº‘å¼€å‘**
   - ç‚¹å‡»å·¥å…·æ ä¸­çš„ **"äº‘å¼€å‘"** æŒ‰é’®
   - å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨ï¼Œä¼šæç¤ºå¼€é€šäº‘å¼€å‘æœåŠ¡
   - ç‚¹å‡» **"å¼€é€š"** æŒ‰é’®

3. **åˆ›å»ºäº‘ç¯å¢ƒ**
   - é€‰æ‹© **"åˆ›å»ºæ–°ç¯å¢ƒ"**
   - ç¯å¢ƒåç§°ï¼š`carpool-dev`ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
   - é€‰æ‹©ä»˜è´¹æ–¹å¼ï¼ˆå»ºè®®é€‰æ‹©æŒ‰é‡ä»˜è´¹ï¼‰
   - ç‚¹å‡» **"åˆ›å»º"**

4. **è·å–ç¯å¢ƒID**
   - åˆ›å»ºå®Œæˆåï¼Œè®°å½•ç¯å¢ƒIDï¼ˆæ ¼å¼ç±»ä¼¼ï¼š`carpool-dev-xxxxx`ï¼‰
   - è¿™ä¸ªIDéœ€è¦å¡«å…¥ `app.js` æ–‡ä»¶ä¸­

## æ­¥éª¤äºŒï¼šé…ç½®äº‘å¼€å‘ç¯å¢ƒID

### æ›´æ–° app.js æ–‡ä»¶

```javascript
// å°† app.js ä¸­çš„ç¯å¢ƒIDæ›¿æ¢ä¸ºä½ çš„å®é™…ç¯å¢ƒID
wx.cloud.init({
  env: 'carpool-dev-xxxxx', // æ›¿æ¢ä¸ºä½ çš„ç¯å¢ƒID
  traceUser: true,
})
```

## æ­¥éª¤ä¸‰ï¼šéƒ¨ç½²äº‘å‡½æ•°

### 1. åŒæ­¥äº‘å‡½æ•°åˆ—è¡¨

1. åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­ï¼Œå³é”®ç‚¹å‡» `cloudfunctions` æ–‡ä»¶å¤¹
2. é€‰æ‹© **"åŒæ­¥äº‘å‡½æ•°åˆ—è¡¨"**
3. é€‰æ‹©ä½ åˆšåˆ›å»ºçš„äº‘ç¯å¢ƒ

### 2. é€ä¸ªéƒ¨ç½²äº‘å‡½æ•°

æŒ‰ä»¥ä¸‹é¡ºåºéƒ¨ç½²äº‘å‡½æ•°ï¼ˆæ¯ä¸ªéƒ½è¦å•ç‹¬éƒ¨ç½²ï¼‰ï¼š

#### åŸºç¡€äº‘å‡½æ•°
```
1. carpool-list      # æ‹¼è½¦åˆ—è¡¨
2. carpool-detail    # æ‹¼è½¦è¯¦æƒ…
3. carpool-create    # åˆ›å»ºæ‹¼è½¦
4. carpool-update    # æ›´æ–°æ‹¼è½¦
5. carpool-join      # å‚ä¸æ‹¼è½¦
6. carpool-quit      # é€€å‡ºæ‹¼è½¦
```

#### ç”¨æˆ·åŠŸèƒ½äº‘å‡½æ•°
```
7. user-info         # ç”¨æˆ·ä¿¡æ¯
8. user-update       # æ›´æ–°ç”¨æˆ·ä¿¡æ¯
9. user-carpools     # ç”¨æˆ·çš„æ‹¼è½¦
10. user-rides       # ç”¨æˆ·å‚ä¸çš„æ‹¼è½¦
```

#### éƒ¨ç½²æ–¹æ³•
å¯¹æ¯ä¸ªäº‘å‡½æ•°æ–‡ä»¶å¤¹ï¼š
1. å³é”®ç‚¹å‡»æ–‡ä»¶å¤¹ï¼ˆå¦‚ `carpool-list`ï¼‰
2. é€‰æ‹© **"ä¸Šä¼ å¹¶éƒ¨ç½²ï¼šäº‘ç«¯å®‰è£…ä¾èµ–"**
3. ç­‰å¾…éƒ¨ç½²å®Œæˆï¼ˆæ˜¾ç¤ºç»¿è‰²å¯¹å‹¾ï¼‰

### 3. éªŒè¯äº‘å‡½æ•°éƒ¨ç½²

åœ¨äº‘å¼€å‘æ§åˆ¶å°çš„"äº‘å‡½æ•°"é¡µé¢ï¼Œåº”è¯¥èƒ½çœ‹åˆ°æ‰€æœ‰10ä¸ªäº‘å‡½æ•°éƒ½æ˜¾ç¤ºä¸º"éƒ¨ç½²æˆåŠŸ"çŠ¶æ€ã€‚

## æ­¥éª¤å››ï¼šåˆå§‹åŒ–äº‘æ•°æ®åº“

### 1. è¿›å…¥æ•°æ®åº“æ§åˆ¶å°

1. åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­ç‚¹å‡» **"äº‘å¼€å‘"**
2. åˆ‡æ¢åˆ° **"æ•°æ®åº“"** æ ‡ç­¾
3. æˆ–è€…ç›´æ¥è®¿é—®äº‘å¼€å‘æ§åˆ¶å°

### 2. åˆ›å»ºæ•°æ®åº“é›†åˆ

#### æ–¹æ³•ä¸€ï¼šæ‰‹åŠ¨åˆ›å»º
1. ç‚¹å‡» **"æ·»åŠ é›†åˆ"**
2. ä¾æ¬¡åˆ›å»ºä»¥ä¸‹é›†åˆï¼š
   - `carpools` - æ‹¼è½¦ä¿¡æ¯
   - `carpool_participants` - æ‹¼è½¦å‚ä¸è€…
   - `users` - ç”¨æˆ·ä¿¡æ¯

#### æ–¹æ³•äºŒï¼šä½¿ç”¨åˆå§‹åŒ–è„šæœ¬
1. åœ¨æ•°æ®åº“æ§åˆ¶å°ä¸­ï¼Œç‚¹å‡» **"æ•°æ®åº“æŒ‡å¼•"**
2. é€‰æ‹© **"æ‰§è¡Œè„šæœ¬"**
3. å¤åˆ¶ `database/init.js` ä¸­çš„å†…å®¹
4. ç²˜è´´åˆ°è„šæœ¬ç¼–è¾‘å™¨ä¸­
5. ç‚¹å‡» **"æ‰§è¡Œ"**

### 3. è®¾ç½®æ•°æ®åº“æƒé™

1. è¿›å…¥ **"æ•°æ®åº“"** â†’ **"å®‰å…¨è§„åˆ™"**
2. ä¸ºæ¯ä¸ªé›†åˆè®¾ç½®æƒé™ï¼š

#### carpools é›†åˆæƒé™
```javascript
{
  "read": true,
  "write": "auth.openid == resource.data._openid"
}
```

#### carpool_participants é›†åˆæƒé™
```javascript
{
  "read": true,
  "write": "auth.openid == resource.data._openid"
}
```

#### users é›†åˆæƒé™
```javascript
{
  "read": "auth.openid == resource.data._openid",
  "write": "auth.openid == resource.data._openid"
}
```

## æ­¥éª¤äº”ï¼šæµ‹è¯•é…ç½®

### 1. é¢„è§ˆå°ç¨‹åº

1. åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­ç‚¹å‡» **"é¢„è§ˆ"**
2. ç”¨æ‰‹æœºå¾®ä¿¡æ‰«ç 
3. åœ¨çœŸæœºä¸Šæµ‹è¯•åŠŸèƒ½

### 2. æ£€æŸ¥åŠŸèƒ½

æµ‹è¯•ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½ï¼š
- [ ] ç”¨æˆ·ç™»å½•
- [ ] æŸ¥çœ‹æ‹¼è½¦åˆ—è¡¨
- [ ] æŸ¥çœ‹æ‹¼è½¦è¯¦æƒ…
- [ ] åˆ›å»ºæ‹¼è½¦ï¼ˆéœ€è¦ç™»å½•ï¼‰
- [ ] å‚ä¸æ‹¼è½¦ï¼ˆéœ€è¦ç™»å½•ï¼‰
- [ ] æŸ¥çœ‹ä¸ªäººä¸­å¿ƒ

### 3. æŸ¥çœ‹æ—¥å¿—

å¦‚æœåŠŸèƒ½å¼‚å¸¸ï¼Œåœ¨äº‘å¼€å‘æ§åˆ¶å°æŸ¥çœ‹ï¼š
- **äº‘å‡½æ•°æ—¥å¿—**ï¼šæŸ¥çœ‹äº‘å‡½æ•°è°ƒç”¨æƒ…å†µ
- **æ•°æ®åº“æ—¥å¿—**ï¼šæŸ¥çœ‹æ•°æ®åº“æ“ä½œè®°å½•

## å¸¸è§é—®é¢˜è§£å†³

### é—®é¢˜1ï¼šäº‘å‡½æ•°è°ƒç”¨å¤±è´¥
**è§£å†³æ–¹æ¡ˆï¼š**
1. æ£€æŸ¥ `app.js` ä¸­çš„ç¯å¢ƒIDæ˜¯å¦æ­£ç¡®
2. ç¡®è®¤äº‘å‡½æ•°å·²æˆåŠŸéƒ¨ç½²
3. æŸ¥çœ‹äº‘å‡½æ•°æ—¥å¿—ä¸­çš„é”™è¯¯ä¿¡æ¯

### é—®é¢˜2ï¼šæ•°æ®åº“æƒé™é”™è¯¯
**è§£å†³æ–¹æ¡ˆï¼š**
1. æ£€æŸ¥æ•°æ®åº“å®‰å…¨è§„åˆ™è®¾ç½®
2. ç¡®è®¤ç”¨æˆ·å·²æ­£ç¡®ç™»å½•
3. éªŒè¯æ•°æ®ç»“æ„æ˜¯å¦æ­£ç¡®

### é—®é¢˜3ï¼šç”¨æˆ·ä¿¡æ¯è·å–å¤±è´¥
**è§£å†³æ–¹æ¡ˆï¼š**
1. ç¡®è®¤å·²éƒ¨ç½² `user-info` äº‘å‡½æ•°
2. æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²æˆæƒ
3. æŸ¥çœ‹æ§åˆ¶å°é”™è¯¯ä¿¡æ¯

### é—®é¢˜4ï¼šé»˜è®¤å¤´åƒä¸æ˜¾ç¤º
**è§£å†³æ–¹æ¡ˆï¼š**
1. æ£€æŸ¥ç½‘ç»œè¿æ¥
2. ç¡®è®¤SVGæ ¼å¼æ”¯æŒ
3. å¯ä»¥ä¸Šä¼ é»˜è®¤å¤´åƒåˆ°äº‘å­˜å‚¨

## é…ç½®æ£€æŸ¥æ¸…å•

å®Œæˆé…ç½®åï¼Œè¯·ç¡®è®¤ä»¥ä¸‹é¡¹ç›®ï¼š

### äº‘å¼€å‘ç¯å¢ƒ
- [ ] äº‘å¼€å‘æœåŠ¡å·²å¼€é€š
- [ ] äº‘ç¯å¢ƒå·²åˆ›å»º
- [ ] ç¯å¢ƒIDå·²é…ç½®åˆ° `app.js`

### äº‘å‡½æ•°
- [ ] carpool-list å·²éƒ¨ç½²
- [ ] carpool-detail å·²éƒ¨ç½²
- [ ] carpool-create å·²éƒ¨ç½²
- [ ] carpool-update å·²éƒ¨ç½²
- [ ] carpool-join å·²éƒ¨ç½²
- [ ] carpool-quit å·²éƒ¨ç½²
- [ ] user-info å·²éƒ¨ç½²
- [ ] user-update å·²éƒ¨ç½²
- [ ] user-carpools å·²éƒ¨ç½²
- [ ] user-rides å·²éƒ¨ç½²

### æ•°æ®åº“
- [ ] carpools é›†åˆå·²åˆ›å»º
- [ ] carpool_participants é›†åˆå·²åˆ›å»º
- [ ] users é›†åˆå·²åˆ›å»º
- [ ] æ•°æ®åº“ç´¢å¼•å·²åˆ›å»º
- [ ] å®‰å…¨è§„åˆ™å·²è®¾ç½®

### åŠŸèƒ½æµ‹è¯•
- [ ] å°ç¨‹åºå¯ä»¥æ­£å¸¸é¢„è§ˆ
- [ ] ç”¨æˆ·ç™»å½•åŠŸèƒ½æ­£å¸¸
- [ ] æ‹¼è½¦åˆ—è¡¨æ˜¾ç¤ºæ­£å¸¸
- [ ] ä¸ªäººä¸­å¿ƒæ•°æ®æ­£å¸¸

## ä¸‹ä¸€æ­¥

é…ç½®å®Œæˆåï¼Œä½ å¯ä»¥ï¼š
1. å¼€å§‹æµ‹è¯•å°ç¨‹åºåŠŸèƒ½
2. æ ¹æ®éœ€è¦è°ƒæ•´ç•Œé¢æ ·å¼
3. æ·»åŠ æ›´å¤šè‡ªå®šä¹‰åŠŸèƒ½
4. å‡†å¤‡æäº¤å®¡æ ¸ä¸Šçº¿

---

**æ³¨æ„**ï¼šé¦–æ¬¡é…ç½®å¯èƒ½éœ€è¦10-15åˆ†é’Ÿï¼Œè¯·è€å¿ƒç­‰å¾…å„é¡¹æœåŠ¡åˆå§‹åŒ–å®Œæˆã€‚ 

### ğŸ“‹ **æ€»ç»“**

ç°åœ¨ä½ æœ‰ä¸¤ç§æ–¹å¼åˆå§‹åŒ–æ•°æ®åº“ï¼š

1. **æ¨èæ–¹å¼**ï¼šä½¿ç”¨ `db-init` äº‘å‡½æ•°ï¼ˆè‡ªåŠ¨åˆ›å»ºé›†åˆå’Œç´¢å¼•ï¼‰
2. **å¤‡é€‰æ–¹å¼**ï¼šåœ¨äº‘å¼€å‘æ§åˆ¶å°æ‰‹åŠ¨åˆ›å»ºé›†åˆ

é€‰æ‹©å…¶ä¸­ä¸€ç§æ–¹å¼å®Œæˆæ•°æ®åº“åˆå§‹åŒ–ï¼Œç„¶åå°±å¯ä»¥ç»§ç»­éƒ¨ç½²å…¶ä»–äº‘å‡½æ•°äº†ï¼

### éªŒè¯æ•°æ®åº“é›†åˆ

```javascript
// éªŒè¯æ•°æ®åº“é›†åˆ
const db = wx.cloud.database()

Promise.all([
  db.collection('carpools').limit(1).get(),
  db.collection('carpool_participants').limit(1).get(),
  db.collection('users').limit(1).get()
]).then(results => {
  console.log('âœ… æ‰€æœ‰æ•°æ®åº“é›†åˆåˆ›å»ºæˆåŠŸ!')
  console.log('carpools:', results[0])
  console.log('carpool_participants:', results[1])
  console.log('users:', results[2])
}).catch(error => {
  console.error('âŒ æ•°æ®åº“éªŒè¯å¤±è´¥:', error)
})
``` 