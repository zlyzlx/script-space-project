<!--pages/index/index.wxml-->
<view class="index-container">
  <!-- ç”¨æˆ·ä¿¡æ¯æ  -->
  <view class="user-bar" bindtap="goToProfile">
    <view class="user-info">
      <image class="user-avatar" src="{{userInfo.avatarUrl || '/images/default-avatar.png'}}" mode="scaleToFill"></image>
      <view class="user-details">
        <view class="user-name">{{userInfo.nickName || 'æœªç™»å½•'}}</view>
        <view class="user-status">{{userInfo.isGuest ? 'æ¸¸å®¢æ¨¡å¼' : 'æ¬¢è¿å›æ¥'}}</view>
      </view>
    </view>
    <view class="arrow-right">></view>
  </view>

  <!-- å¿«é€Ÿæ“ä½œ -->
  <view class="quick-actions">
    <view class="action-item" bindtap="goToPublish">
      <view class="action-icon publish-icon">ğŸ“</view>
      <view class="action-text">å‘å¸ƒæ‹¼è½¦</view>
    </view>
    <view class="action-item" bindtap="goToCarpoolList">
      <view class="action-icon search-icon">ğŸ”</view>
      <view class="action-text">æŸ¥æ‰¾æ‹¼è½¦</view>
    </view>
    <view class="action-item" bindtap="goToProfile">
      <view class="action-icon profile-icon">ğŸ‘¤</view>
      <view class="action-text">æˆ‘çš„æ‹¼è½¦</view>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading-container">
    <view class="loading-text">åŠ è½½ä¸­...</view>
  </view>

  <!-- å†…å®¹åŒºåŸŸ -->
  <view wx:else class="content-container">
    <!-- æœ€æ–°æ‹¼è½¦ -->
    <view class="section">
      <view class="section-header">
        <view class="section-title">æœ€æ–°æ‹¼è½¦</view>
        <view class="section-more" bindtap="goToCarpoolList">æŸ¥çœ‹æ›´å¤š ></view>
      </view>
      
      <view wx:if="{{recentCarpools.length > 0}}" class="carpool-list">
        <view 
          wx:for="{{recentCarpools}}" 
          wx:key="_id" 
          class="carpool-item"
          data-id="{{item._id}}"
          bindtap="viewCarpoolDetail"
        >
          <view class="carpool-header">
            <view class="carpool-title">{{item.activityName}}</view>
            <view class="carpool-status {{item.status === 'æ‹›å‹Ÿä¸­' ? 'recruiting' : 'full'}}">
              {{item.status}}
            </view>
          </view>
          
          <view class="carpool-info">
            <view class="info-item">
              <text class="info-icon">ğŸ“…</text>
              <text class="info-text">{{item.date}} {{item.time}}</text>
            </view>
            <view class="info-item">
              <text class="info-icon">ğŸ“</text>
              <text class="info-text">{{item.location}}</text>
            </view>
            <view class="info-item">
              <text class="info-icon">ğŸ‘¥</text>
              <text class="info-text">{{item.currentCount}}/{{item.maxCount}}äºº</text>
            </view>
          </view>
        </view>
      </view>
      
      <view wx:else class="empty-state">
        <view class="empty-icon">ğŸš—</view>
        <view class="empty-text">æš‚æ— æ‹¼è½¦ä¿¡æ¯</view>
      </view>
    </view>

    <!-- çƒ­é—¨æ‹¼è½¦ -->
    <view class="section">
      <view class="section-header">
        <view class="section-title">çƒ­é—¨æ‹¼è½¦</view>
        <view class="section-more" bindtap="goToCarpoolList">æŸ¥çœ‹æ›´å¤š ></view>
      </view>
      
      <view wx:if="{{hotCarpools.length > 0}}" class="carpool-list">
        <view 
          wx:for="{{hotCarpools}}" 
          wx:key="_id" 
          class="carpool-item"
          data-id="{{item._id}}"
          bindtap="viewCarpoolDetail"
        >
          <view class="carpool-header">
            <view class="carpool-title">{{item.activityName}}</view>
            <view class="carpool-price">Â¥{{item.price}}</view>
          </view>
          
          <view class="carpool-info">
            <view class="info-item">
              <text class="info-icon">ğŸ“…</text>
              <text class="info-text">{{item.date}} {{item.time}}</text>
            </view>
            <view class="info-item">
              <text class="info-icon">ğŸ“</text>
              <text class="info-text">{{item.location}}</text>
            </view>
            <view class="info-item">
              <text class="info-icon">ğŸ‘¥</text>
              <text class="info-text">{{item.currentCount}}/{{item.maxCount}}äºº</text>
            </view>
          </view>
        </view>
      </view>
      
      <view wx:else class="empty-state">
        <view class="empty-icon">ğŸ”¥</view>
        <view class="empty-text">æš‚æ— çƒ­é—¨æ‹¼è½¦</view>
      </view>
    </view>
  </view>
</view> 